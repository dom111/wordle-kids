(()=>{var Tt=Object.create;var dt=Object.defineProperty;var Lt=Object.getOwnPropertyDescriptor;var Mt=Object.getOwnPropertyNames;var kt=Object.getPrototypeOf,Yt=Object.prototype.hasOwnProperty;var jt=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var zt=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Mt(t))!Yt.call(i,n)&&n!==e&&dt(i,n,{get:()=>t[n],enumerable:!(s=Lt(t,n))||s.enumerable});return i};var y=(i,t,e)=>(e=i!=null?Tt(kt(i)):{},zt(t||!i||!i.__esModule?dt(e,"default",{value:i,enumerable:!0}):e,i));var G=jt(o=>{"use strict";var Q,Pt=o&&o.__classPrivateFieldSet||function(i,t,e,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(i,e):n?n.value=e:t.set(i,e),e},Kt=o&&o.__classPrivateFieldGet||function(i,t,e,s){if(e==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!s:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?s:e==="a"?s.call(i):s?s.value:t.get(i)};Object.defineProperty(o,"__esModule",{value:!0}),o.Element=o.toggleClass=o.t=o.s=o.removeClass=o.once=o.onEach=o.on=o.off=o.hasClass=o.empty=o.emitCustom=o.emit=o.addClass=void 0;o.addClass=(i,...t)=>i.classList.add(...t);o.emit=(i,t)=>i.dispatchEvent(t);o.emitCustom=(i,t,...e)=>(0,o.emit)(i,new CustomEvent(t,{detail:e}));o.empty=i=>{for(var t;i.hasChildNodes();)(t=i.firstChild)===null||t===void 0||t.remove()};o.hasClass=(i,t)=>i.classList.contains(t);o.off=(i,t,e,s={})=>i.removeEventListener(t,e,s);o.on=(i,t,e,s={})=>i.addEventListener(t,e,s);o.onEach=(i,t,e,s={})=>t.forEach((n=>(0,o.on)(i,n,e,s)));o.once=(i,t,e,s={})=>(0,o.on)(i,t,e,Object.assign(Object.assign({},typeof s=="boolean"?{capture:s}:s),{once:!0}));o.removeClass=(i,...t)=>i.classList.remove(...t);o.s=(i,...t)=>{let e=document.createElement("div");e.innerHTML=i;let s=e.firstElementChild;return t.forEach((n=>{n instanceof F?s.append(n.element()):n instanceof Node?s.append(n):s.append((0,o.t)(n))})),s};o.t=i=>document.createTextNode(i);o.toggleClass=(i,...t)=>t.forEach((e=>i.classList.toggle(e)));var F=class i{constructor(t){Q.set(this,void 0),Pt(this,Q,t,"f")}static fromString(t){return new i((0,o.s)(t))}addClass(...t){(0,o.addClass)(this.element(),...t)}append(...t){t.forEach((e=>{e instanceof i&&(e=e.element()),this.element().append(e)}))}element(){return Kt(this,Q,"f")}emit(t){return(0,o.emit)(this.element(),t)}emitCustom(t,...e){return(0,o.emitCustom)(this.element(),t,...e)}empty(){(0,o.empty)(this.element())}hasClass(t){return(0,o.hasClass)(this.element(),t)}off(t,e,s={}){(0,o.off)(this.element(),t,e,s)}on(t,e,s={}){(0,o.on)(this.element(),t,e,s)}onEach(t,e,s={}){(0,o.onEach)(this.element(),t,e,s)}once(t,e,s={}){(0,o.once)(this.element(),t,e,s)}query(t){return this.element().querySelector(t)}queryAll(t){return this.element().querySelectorAll(t)}remove(){this.element().remove()}removeClass(...t){(0,o.removeClass)(this.element(),...t)}toggleClass(...t){(0,o.toggleClass)(this.element(),...t)}};o.Element=F,Q=new WeakMap,o.default=F});var ut=(s=>(s[s.EASY=0]="EASY",s[s.NORMAL=1]="NORMAL",s[s.HARD=2]="HARD",s))(ut||{}),j=[0,1,2],Ht={0:"Easy",1:"Normal",2:"Hard"},D=i=>Ht[i]??"Invalid",ht=i=>{let t=parseInt(i);if(!j.includes(t))throw new TypeError(`Invalid Difficulty: ${i}`);return t},U=ut;var mt=(n=>(n[n.UNKNOWN=-1]="UNKNOWN",n[n.WRONG=0]="WRONG",n[n.WRONG_PLACE=1]="WRONG_PLACE",n[n.RIGHT=2]="RIGHT",n))(mt||{}),C=mt;var z=class extends TypeError{},X=z;var H=[{label:"Animals",path:"./lists/themes/animals.json"}],J=i=>{let[t]=H.filter(e=>e.path===i);if(!t)throw new X(`Unknown theme '${i}'.`);return t},gt=i=>J(i).label??"Unknown";var pt=[3,4,5],Jt={3:"./lists/3-letter.json",4:"./lists/4-letter.json",5:"./lists/5-letter.json"},S=new Map,bt=i=>(S.has(i)||S.set(i,fetch(Jt[i]).then(t=>t.json())),S.get(i));var ft=(e=>(e[e.FREE_PLAY=0]="FREE_PLAY",e[e.THEMED=1]="THEMED",e))(ft||{}),P=[0,1],St={0:"Free Play",1:"Themed"},V=i=>St[i]??"Invalid",Ct=i=>{let t=parseInt(i);if(!P.includes(t))throw new TypeError(`Invalid Mode: ${i}`);return t},A=ft;var K=class{#t;#e=U.EASY;#i;#s={};#r;#a;#o="";#n=[];constructor(t){this.#a=t}async addAllValidWords(t){await Promise.all(t.map(e=>this.addValidWords(e)))}async addValidWords(t){(await bt(t)).forEach(s=>this.#n.push(s.toUpperCase()))}currentTarget(){return this.#t}currentWordLength(){return this.#t.word.length}difficulty(){return this.#e}letterScore(t){return this.#s[t]??C.UNKNOWN}mode(){return this.#r}score(t){let e=[...this.#t.word];return e.reduce((s,n,r)=>(n===t[r]&&(this.#s[n]=s[r]=C.RIGHT,e[r]=null),s),new Array(this.currentWordLength()).fill(C.UNKNOWN)).map((s,n)=>{if(s===C.RIGHT)return s;let r=e.indexOf(t[n]);return r>-1?(e[r]=null,this.#s[t[n]]=C.WRONG_PLACE):this.#s[t[n]]=C.WRONG})}setDifficulty(t){this.#e=t}async setFreePlay(t){await this.addAllValidWords(t);let e=this.#n[Math.floor(this.#n.length*Math.random())].toUpperCase();this.#t={word:e,difficulty:0,clues:[]}}setLengths(t){this.#i=t}setMode(t){this.#r=t}async setThemedGame(t,e){let s=J(t);this.#o=t;let r=(await(await fetch(s.path)).json()).words.filter(h=>h.difficulty<=e),p=r.reduce((h,{word:w})=>(h.includes(w.length)||h.push(w.length),h),[]);await this.addAllValidWords(p),r.map(({word:h})=>h.toUpperCase()).forEach(h=>{this.#n.includes(h)||this.#n.push(h)});let{word:b,difficulty:m,clues:f}=r[Math.floor(r.length*Math.random())];this.#t={word:b.toUpperCase(),difficulty:m,clues:f}}setTheme(t){this.#o=t}async start(){if(this.#r===A.THEMED&&!this.#o)throw new X("Expected `theme` when using `Mode.THEMED`.");if(this.#s={},this.#r===A.THEMED){await this.setThemedGame(this.#o,this.#e),this.#a();return}if(this.#r===A.FREE_PLAY){await this.setFreePlay(this.#i),this.#a();return}}theme(){return this.#o}validate(t){return this.#n.includes(t.join(""))}},It=K;var wt=y(G());var vt=y(G());var N=y(G());var u;(function(i){i.Attribute="attribute",i.Pseudo="pseudo",i.PseudoElement="pseudo-element",i.Tag="tag",i.Universal="universal",i.Adjacent="adjacent",i.Child="child",i.Descendant="descendant",i.Parent="parent",i.Sibling="sibling",i.ColumnCombinator="column-combinator"})(u||(u={}));var I;(function(i){i.Any="any",i.Element="element",i.End="end",i.Equals="equals",i.Exists="exists",i.Hyphen="hyphen",i.Not="not",i.Start="start"})(I||(I={}));var At=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,qt=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,$t=new Map([[126,I.Element],[94,I.Start],[36,I.End],[42,I.Any],[33,I.Not],[124,I.Hyphen]]),_t=new Set(["has","not","matches","is","where","host","host-context"]);function Bt(i){switch(i.type){case u.Adjacent:case u.Child:case u.Descendant:case u.Parent:case u.Sibling:case u.ColumnCombinator:return!0;default:return!1}}var te=new Set(["contains","icontains"]);function ee(i,t,e){let s=parseInt(t,16)-65536;return s!==s||e?t:s<0?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,s&1023|56320)}function W(i){return i.replace(qt,ee)}function q(i){return i===39||i===34}function Gt(i){return i===32||i===9||i===10||i===12||i===13}function $(i){let t=[],e=yt(t,`${i}`,0);if(e<i.length)throw new Error(`Unmatched selector: ${i.slice(e)}`);return t}function yt(i,t,e){let s=[];function n(l){let c=t.slice(e+l).match(At);if(!c)throw new Error(`Expected name, found ${t.slice(e)}`);let[d]=c;return e+=l+d.length,W(d)}function r(l){for(e+=l;e<t.length&&Gt(t.charCodeAt(e));)e++}function p(){e+=1;let l=e,c=1;for(;c>0&&e<t.length;e++)t.charCodeAt(e)===40&&!b(e)?c++:t.charCodeAt(e)===41&&!b(e)&&c--;if(c)throw new Error("Parenthesis not matched");return W(t.slice(l,e-1))}function b(l){let c=0;for(;t.charCodeAt(--l)===92;)c++;return(c&1)===1}function m(){if(s.length>0&&Bt(s[s.length-1]))throw new Error("Did not expect successive traversals.")}function f(l){if(s.length>0&&s[s.length-1].type===u.Descendant){s[s.length-1].type=l;return}m(),s.push({type:l})}function h(l,c){s.push({type:u.Attribute,name:l,action:c,value:n(1),namespace:null,ignoreCase:"quirks"})}function w(){if(s.length&&s[s.length-1].type===u.Descendant&&s.pop(),s.length===0)throw new Error("Empty sub-selector");i.push(s)}if(r(0),t.length===e)return e;t:for(;e<t.length;){let l=t.charCodeAt(e);switch(l){case 32:case 9:case 10:case 12:case 13:{(s.length===0||s[0].type!==u.Descendant)&&(m(),s.push({type:u.Descendant})),r(1);break}case 62:{f(u.Child),r(1);break}case 60:{f(u.Parent),r(1);break}case 126:{f(u.Sibling),r(1);break}case 43:{f(u.Adjacent),r(1);break}case 46:{h("class",I.Element);break}case 35:{h("id",I.Equals);break}case 91:{r(1);let c,d=null;t.charCodeAt(e)===124?c=n(1):t.startsWith("*|",e)?(d="*",c=n(2)):(c=n(0),t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==61&&(d=c,c=n(1))),r(0);let B=I.Exists,lt=$t.get(t.charCodeAt(e));if(lt){if(B=lt,t.charCodeAt(e+1)!==61)throw new Error("Expected `=`");r(2)}else t.charCodeAt(e)===61&&(B=I.Equals,r(1));let k="",Y=null;if(B!=="exists"){if(q(t.charCodeAt(e))){let Z=t.charCodeAt(e),x=e+1;for(;x<t.length&&(t.charCodeAt(x)!==Z||b(x));)x+=1;if(t.charCodeAt(x)!==Z)throw new Error("Attribute value didn't end");k=W(t.slice(e+1,x)),e=x+1}else{let Z=e;for(;e<t.length&&(!Gt(t.charCodeAt(e))&&t.charCodeAt(e)!==93||b(e));)e+=1;k=W(t.slice(Z,e))}r(0);let ct=t.charCodeAt(e)|32;ct===115?(Y=!1,r(1)):ct===105&&(Y=!0,r(1))}if(t.charCodeAt(e)!==93)throw new Error("Attribute selector didn't terminate");e+=1;let Nt={type:u.Attribute,name:c,action:B,value:k,namespace:d,ignoreCase:Y};s.push(Nt);break}case 58:{if(t.charCodeAt(e+1)===58){s.push({type:u.PseudoElement,name:n(2).toLowerCase(),data:t.charCodeAt(e)===40?p():null});continue}let c=n(1).toLowerCase(),d=null;if(t.charCodeAt(e)===40)if(_t.has(c)){if(q(t.charCodeAt(e+1)))throw new Error(`Pseudo-selector ${c} cannot be quoted`);if(d=[],e=yt(d,t,e+1),t.charCodeAt(e)!==41)throw new Error(`Missing closing parenthesis in :${c} (${t})`);e+=1}else{if(d=p(),te.has(c)){let B=d.charCodeAt(0);B===d.charCodeAt(d.length-1)&&q(B)&&(d=d.slice(1,-1))}d=W(d)}s.push({type:u.Pseudo,name:c,data:d});break}case 44:{w(),s=[],r(1);break}default:{if(t.startsWith("/*",e)){let B=t.indexOf("*/",e+2);if(B<0)throw new Error("Comment was not terminated");e=B+2,s.length===0&&r(0);break}let c=null,d;if(l===42)e+=1,d="*";else if(l===124){if(d="",t.charCodeAt(e+1)===124){f(u.ColumnCombinator),r(2);break}}else if(At.test(t.slice(e)))d=n(0);else break t;t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==124&&(c=d,t.charCodeAt(e+1)===42?(d="*",e+=2):d=n(1)),s.push(d==="*"?{type:u.Universal,namespace:c}:{type:u.Tag,name:d,namespace:c})}}}return w(),e}var a=(i,...t)=>{let[e]=$(i).map(s=>s.reduce((n,r)=>(n===null&&r.type!=="tag"&&(n=document.createElement("div")),r.type==="tag"?document.createElement(r.name):(r.type==="attribute"&&r.name!=="class"&&n.setAttribute(r.name,r.value??""),r.type==="attribute"&&r.name==="class"&&n.classList.add(r.value),n)),null));return t.forEach(s=>e.append(s)),e};var _=class extends N.default{#t="";constructor(){super(a('span.letter[tabindex="-1"]'))}hasValue(){return this.#t!==""}highlight(t){if(t===C.RIGHT){this.element().classList.add("right");return}if(t===C.WRONG_PLACE){this.element().classList.add("wrong-place");return}if(t===C.WRONG){this.element().classList.add("wrong");return}}setValue(t){this.#t=t,this.empty(),this.append((0,N.t)(t))}value(){return this.#t}},T=_;var tt=class extends vt.default{#t=[];#e;constructor(t){super(a(".guess")),this.#e=t;for(let e=0;e<t;e++)this.#t.push(new T);this.append(...this.#t.map(e=>e.element()))}applyScore(t){this.#t.forEach((e,s)=>e.highlight(t[s]))}celebrate(){this.addClass("dance")}clearError(){this.element().classList.remove("error")}guess(){return this.#t.map(t=>t.value())}highlightError(){this.element().classList.add("error")}length(){return this.#t.filter(t=>t.hasValue()).length}onInput(t){if(!(t==="Backspace"&&this.length()===0)){if(t==="Backspace"){this.clearError(),this.#t[this.length()-1].setValue("");return}this.length()!==this.#e&&this.#t[this.length()].setValue(t)}}},Ot=tt;var et=class extends wt.default{#t=!1;#e;#i=[];constructor(t){super(a('section.guesses[tabindex="0"][aria-label="Enter your guess"][autofocus]')),this.#e=t,this.addGuess()}addGuess(){this.#i.push(new Ot(this.#e.currentWordLength())),this.append(this.currentGuess().element()),requestAnimationFrame(()=>this.element().scrollTo({top:this.element().scrollHeight}))}currentGuess(){return this.#i[this.#i.length-1]}onInput(t){if(this.#t)return;let e=this.currentGuess().guess(),s=this.currentGuess().length()===this.#e.currentWordLength(),n=this.#e.validate(e);if(t==="Enter"&&s&&n){let r=this.#e.score(e);if(this.currentGuess().applyScore(r),r.every(p=>p===C.RIGHT)){this.#t=!0,this.currentGuess().celebrate();return}this.addGuess();return}t==="Enter"&&s&&!n&&this.currentGuess().highlightError(),t==="Backspace"&&this.currentGuess().onInput(t),t.match(/^[A-Z]$/i)&&this.currentGuess().onInput(t.toUpperCase())}},xt=et;var v=y(G());var g=y(G());var Et=y(G());var it=class extends Et.default{#t;constructor(...t){super(a('dialog[tabindex="0"]')),this.#t=a(".content",...t),this.element().append(this.#t),document.body.append(this.element()),this.bindEvents()}append(...t){this.#t.append(...t)}bindEvents(){this.on("click",t=>{t.target===this.element()&&this.close()}),this.on("keydown",t=>{t.key==="Escape"&&this.close()})}close(){this.element().removeAttribute("open")}open(){this.element().setAttribute("open",""),this.element().focus()}setLabel(t){this.element().setAttribute("aria-label",t)}},Rt=it;var Ft=i=>i.setAttribute("hidden",""),Wt=i=>i.removeAttribute("hidden"),st=class extends Rt{constructor(t){super(a("h2",(0,g.t)("Options"))),this.addClass("options"),this.setLabel("Options dialog. Close with Escape key");let e=a("select#mode",...P.map(l=>a(`option[value="${l}"]`+(l===t.mode()?"[selected]":""),(0,g.t)(V(l))))),s=a("select#theme",...H.map(({label:l,path:c})=>a(`option[value="${c}"]`+(c===t.theme()?"[selected]":""),(0,g.t)(l)))),n=a("select#difficulty",...j.map(l=>a(`option[value="${l}"]`+(l===t.difficulty()?"[selected]":""),(0,g.t)(D(l))))),r=a("fieldset",a('label[for="mode"][aria-label="Choose game mode"]',(0,g.t)("Game mode")),e),p=a("fieldset"+(t.mode()!==A.THEMED?"[hidden]":""),a('label[for="mode"][aria-label="Choose theme"]',(0,g.t)("Theme")),s),b=a("fieldset"+(t.mode()!==A.THEMED?"[hidden]":""),a('label[for="difficulty"][aria-label="Choose difficulty"]',(0,g.t)("Difficulty")),n),m=a("button",(0,g.t)("Apply")),f=l=>{if(l=Ct(l),t.setMode(l),l===A.THEMED){Wt(b),Wt(p);return}Ft(b),Ft(p)},h=l=>t.setTheme(l),w=l=>t.setDifficulty(ht(l));(0,g.on)(e,"change",()=>f(e.value)),(0,g.on)(s,"change",()=>h(s.value)),(0,g.on)(n,"change",()=>w(n.value)),(0,g.on)(m,"click",()=>{t.start(),this.close()}),this.append(a("div",r,p,b,a("fieldset",m)))}},Zt=st;var L=y(G());var E=y(G());var nt=class extends E.default{#t;#e;constructor(t,e){super(a("div.tooltip")),this.#t=t,this.#e=e,this.append((0,E.t)(this.#t)),this.bindEvents()}bindEvents(){(0,E.on)(this.#e,"mouseenter",()=>this.show()),(0,E.on)(this.#e,"mouseleave",()=>this.hide())}hide(){this.removeClass("show"),requestAnimationFrame(()=>this.position())}position(){this.element().style.setProperty("top",`${this.#e.offsetTop+this.#e.offsetHeight+10}px`);let t=this.#e.offsetLeft+this.#e.offsetWidth/2-this.element().offsetWidth/2;t=Math.max(0,Math.min(t,window.innerWidth-this.element().offsetWidth)),this.element().style.setProperty("left",`${t}px`)}show(){this.addClass("show")}},Dt=nt;var rt=class extends L.default{constructor(t,e){super(a("button.button",(0,L.t)(t))),this.append(new Dt(e,this.element()))}},M=rt;var ot=class extends v.default{constructor(t){super(a("nav.header",a("header",a("h1",(0,v.t)("Wordle Kids")),a("section.actions")),a("h3",(0,v.t)(V(t.mode())+(t.mode()===A.THEMED?` (${gt(t.theme())}) - ${D(t.difficulty())}`:""))),a("p",(0,v.t)("A kid-friendly Wordle clone with small words and clues.")),a(".clues")));let e=this.element().querySelector(".clues"),s=new Zt(t),n=new v.default(this.element().querySelector("section.actions")),r=new M("\u21BB","New game"),p=new M("?","Get a hint"),b=new M("\u2699","Options");r.on("click",m=>{t.start(),m.preventDefault(),m.stopPropagation()}),p.on("click",m=>{let f=e.childNodes.length,h=t.currentTarget().clues??[];m.preventDefault(),m.stopPropagation(),f===h.length&&e.append(a(".clue.no-more",(0,v.t)("No more clues!"))),!(f>=h.length)&&e.append(a(".clue",(0,v.t)(h[f])))}),b.on("click",m=>{s.open(),m.preventDefault(),m.stopPropagation()}),n.append(r,p,b)}},Ut=ot;var R=y(G());var Xt={Backspace:"\u232B"},at=class extends R.default{#t;#e;#i={};#s=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Backspace","Z","X","C","V","B","N","M","Enter"]];constructor(t,e){super(a("section.keyboard[autofocus]")),this.append(...this.#s.map(s=>a("section.row",...s.map(n=>{let r=new T;return this.#i[n]=r,r.setValue(n),r.element().setAttribute("data-key",n),Object.prototype.hasOwnProperty.call(Xt,n)&&(r.empty(),r.append((0,R.t)(Xt[n]??n))),r.on("click",()=>this.handleInput(n)),r.element()})))),this.#e=t,this.#t=e,this.bindKeyboard()}bindKeyboard(){(0,R.on)(document,"keydown",t=>this.handleInput(t.key))}handleInput(t){this.#e.onInput(t),this.#s.flat().forEach(e=>{let s=this.#i[e],n=this.#t.letterScore(e);s.highlight(n)})}},Vt=at;var Qt=y(G());var O=new It(()=>{let i=new Ut(O),t=new xt(O),e=new Vt(t,O),s=document.getElementById("app");(0,Qt.empty)(s),s.append(i.element(),t.element(),e.element())});O.setDifficulty(U.EASY);O.setLengths(pt);O.setMode(A.THEMED);O.setTheme("./lists/themes/animals.json");O.start();})();
//# sourceMappingURL=app.js.map
