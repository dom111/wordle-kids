(()=>{var bt=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var s=(n,e,t)=>(bt(n,e,"read from private field"),t?t.call(n):e.get(n)),p=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},E=(n,e,t,i)=>(bt(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var K=(n,e,t)=>new Promise((i,o)=>{var r=g=>{try{m(t.next(g))}catch(y){o(y)}},d=g=>{try{m(t.throw(g))}catch(y){o(y)}},m=g=>g.done?i(g.value):Promise.resolve(g.value).then(r,d);m((t=t.apply(n,e)).next())});var Lt=(i=>(i[i.EASY=0]="EASY",i[i.NORMAL=1]="NORMAL",i[i.HARD=2]="HARD",i))(Lt||{}),wt=[0,1,2],Bt={[0]:"Easy",[1]:"Normal",[2]:"Hard"},z=n=>{var e;return(e=Bt[n])!=null?e:"Invalid"},J=Lt;var At=(o=>(o[o.UNKNOWN=-1]="UNKNOWN",o[o.WRONG=0]="WRONG",o[o.WRONG_PLACE=1]="WRONG_PLACE",o[o.RIGHT=2]="RIGHT",o))(At||{}),b=At;var it=class extends TypeError{},X=it;var rt=[{label:"Animals",path:"./lists/themes/animals.json"}],st=n=>{let[e]=rt.filter(t=>t.path===n);if(!e)throw new X(`Unknown theme '${n}'.`);return e},Ct=n=>{var e;return(e=st(n).label)!=null?e:"Unknown"};var Tt=[3,4,5],qt={3:"./lists/3-letter.json",4:"./lists/4-letter.json",5:"./lists/5-letter.json"},Mt=n=>fetch(qt[n]).then(e=>e.json());var Gt=(t=>(t[t.FREE_PLAY=0]="FREE_PLAY",t[t.THEMED=1]="THEMED",t))(Gt||{}),St=[0,1],Yt={[0]:"Free Play",[1]:"Themed"},I=n=>{var e;return(e=Yt[n])!=null?e:"Invalid"},T=Gt;var S,R,$,k,D,x,W,G,ot=class{constructor(e){p(this,S,void 0);p(this,R,J.EASY);p(this,$,void 0);p(this,k,{});p(this,D,void 0);p(this,x,void 0);p(this,W,"");p(this,G,[]);E(this,x,e)}addAllValidWords(e){return K(this,null,function*(){yield Promise.all(e.map(t=>this.addValidWords(t)))})}addValidWords(e){return K(this,null,function*(){(yield Mt(e)).forEach(i=>s(this,G).push(i.toUpperCase()))})}currentTarget(){return s(this,S)}currentWordLength(){return s(this,S).word.length}difficulty(){return s(this,R)}letterScore(e){var t;return(t=s(this,k)[e])!=null?t:b.UNKNOWN}mode(){return s(this,D)}score(e){let t=[...s(this,S).word];return t.reduce((i,o,r)=>(o===e[r]&&(s(this,k)[o]=i[r]=b.RIGHT,t[r]=null),i),new Array(this.currentWordLength()).fill(b.UNKNOWN)).map((i,o)=>{if(i===b.RIGHT)return i;let r=t.indexOf(e[o]);return r>-1?(t[r]=null,s(this,k)[e[o]]=b.WRONG_PLACE):s(this,k)[e[o]]=b.WRONG})}setDifficulty(e){E(this,R,e)}setFreePlay(e){return K(this,null,function*(){yield this.addAllValidWords(e);let t=s(this,G)[Math.floor(s(this,G).length*Math.random())].toUpperCase();E(this,S,{word:t,difficulty:0,clues:[]})})}setLengths(e){E(this,$,e)}setMode(e){E(this,D,e)}setThemedGame(e,t){return K(this,null,function*(){let i=st(e);E(this,W,e);let r=(yield(yield fetch(i.path)).json()).words.filter(v=>v.difficulty<=t),d=r.reduce((v,{word:O})=>(v.includes(O.length)||v.push(O.length),v),[]);yield this.addAllValidWords(d),r.map(({word:v})=>v.toUpperCase()).forEach(v=>{s(this,G).includes(v)||s(this,G).push(v)});let{word:m,difficulty:g,clues:y}=r[Math.floor(r.length*Math.random())];E(this,S,{word:m.toUpperCase(),difficulty:g,clues:y})})}setTheme(e){E(this,W,e)}start(){return K(this,null,function*(){if(s(this,D)===T.THEMED&&!s(this,W))throw new X("Expected `theme` when using `Mode.THEMED`.");if(s(this,D)===T.THEMED){yield this.setThemedGame(s(this,W),s(this,R)),s(this,x).call(this);return}if(s(this,D)===T.FREE_PLAY){yield this.setFreePlay(s(this,$)),s(this,x).call(this);return}})}theme(){return s(this,W)}validate(e){return s(this,G).includes(e.join(""))}};S=new WeakMap,R=new WeakMap,$=new WeakMap,k=new WeakMap,D=new WeakMap,x=new WeakMap,W=new WeakMap,G=new WeakMap;var Dt=ot;var c;(function(n){n.Attribute="attribute",n.Pseudo="pseudo",n.PseudoElement="pseudo-element",n.Tag="tag",n.Universal="universal",n.Adjacent="adjacent",n.Child="child",n.Descendant="descendant",n.Parent="parent",n.Sibling="sibling",n.ColumnCombinator="column-combinator"})(c||(c={}));var L;(function(n){n.Any="any",n.Element="element",n.End="end",n.Equals="equals",n.Exists="exists",n.Hyphen="hyphen",n.Not="not",n.Start="start"})(L||(L={}));var Wt=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,_t=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,Qt=new Map([[126,L.Element],[94,L.Start],[36,L.End],[42,L.Any],[33,L.Not],[124,L.Hyphen]]),Zt=new Set(["has","not","matches","is","where","host","host-context"]);function Nt(n){switch(n.type){case c.Adjacent:case c.Child:case c.Descendant:case c.Parent:case c.Sibling:case c.ColumnCombinator:return!0;default:return!1}}var zt=new Set(["contains","icontains"]);function Jt(n,e,t){let i=parseInt(e,16)-65536;return i!==i||t?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)}function F(n){return n.replace(_t,Jt)}function at(n){return n===39||n===34}function Ht(n){return n===32||n===9||n===10||n===12||n===13}function lt(n){let e=[],t=Ot(e,`${n}`,0);if(t<n.length)throw new Error(`Unmatched selector: ${n.slice(t)}`);return e}function Ot(n,e,t){let i=[];function o(a){let l=e.slice(t+a).match(Wt);if(!l)throw new Error(`Expected name, found ${e.slice(t)}`);let[u]=l;return t+=a+u.length,F(u)}function r(a){for(t+=a;t<e.length&&Ht(e.charCodeAt(t));)t++}function d(){t+=1;let a=t,l=1;for(;l>0&&t<e.length;t++)e.charCodeAt(t)===40&&!m(t)?l++:e.charCodeAt(t)===41&&!m(t)&&l--;if(l)throw new Error("Parenthesis not matched");return F(e.slice(a,t-1))}function m(a){let l=0;for(;e.charCodeAt(--a)===92;)l++;return(l&1)===1}function g(){if(i.length>0&&Nt(i[i.length-1]))throw new Error("Did not expect successive traversals.")}function y(a){if(i.length>0&&i[i.length-1].type===c.Descendant){i[i.length-1].type=a;return}g(),i.push({type:a})}function v(a,l){i.push({type:c.Attribute,name:a,action:l,value:o(1),namespace:null,ignoreCase:"quirks"})}function O(){if(i.length&&i[i.length-1].type===c.Descendant&&i.pop(),i.length===0)throw new Error("Empty sub-selector");n.push(i)}if(r(0),e.length===t)return t;t:for(;t<e.length;){let a=e.charCodeAt(t);switch(a){case 32:case 9:case 10:case 12:case 13:{(i.length===0||i[0].type!==c.Descendant)&&(g(),i.push({type:c.Descendant})),r(1);break}case 62:{y(c.Child),r(1);break}case 60:{y(c.Parent),r(1);break}case 126:{y(c.Sibling),r(1);break}case 43:{y(c.Adjacent),r(1);break}case 46:{v("class",L.Element);break}case 35:{v("id",L.Equals);break}case 91:{r(1);let l,u=null;e.charCodeAt(t)===124?l=o(1):e.startsWith("*|",t)?(u="*",l=o(2)):(l=o(0),e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==61&&(u=l,l=o(1))),r(0);let C=L.Exists,vt=Qt.get(e.charCodeAt(t));if(vt){if(C=vt,e.charCodeAt(t+1)!==61)throw new Error("Expected `=`");r(2)}else e.charCodeAt(t)===61&&(C=L.Equals,r(1));let et="",nt=null;if(C!=="exists"){if(at(e.charCodeAt(t))){let Z=e.charCodeAt(t),P=t+1;for(;P<e.length&&(e.charCodeAt(P)!==Z||m(P));)P+=1;if(e.charCodeAt(P)!==Z)throw new Error("Attribute value didn't end");et=F(e.slice(t+1,P)),t=P+1}else{let Z=t;for(;t<e.length&&(!Ht(e.charCodeAt(t))&&e.charCodeAt(t)!==93||m(t));)t+=1;et=F(e.slice(Z,t))}r(0);let yt=e.charCodeAt(t)|32;yt===115?(nt=!1,r(1)):yt===105&&(nt=!0,r(1))}if(e.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;let Vt={type:c.Attribute,name:l,action:C,value:et,namespace:u,ignoreCase:nt};i.push(Vt);break}case 58:{if(e.charCodeAt(t+1)===58){i.push({type:c.PseudoElement,name:o(2).toLowerCase(),data:e.charCodeAt(t)===40?d():null});continue}let l=o(1).toLowerCase(),u=null;if(e.charCodeAt(t)===40)if(Zt.has(l)){if(at(e.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${l} cannot be quoted`);if(u=[],t=Ot(u,e,t+1),e.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${l} (${e})`);t+=1}else{if(u=d(),zt.has(l)){let C=u.charCodeAt(0);C===u.charCodeAt(u.length-1)&&at(C)&&(u=u.slice(1,-1))}u=F(u)}i.push({type:c.Pseudo,name:l,data:u});break}case 44:{O(),i=[],r(1);break}default:{if(e.startsWith("/*",t)){let C=e.indexOf("*/",t+2);if(C<0)throw new Error("Comment was not terminated");t=C+2,i.length===0&&r(0);break}let l=null,u;if(a===42)t+=1,u="*";else if(a===124){if(u="",e.charCodeAt(t+1)===124){y(c.ColumnCombinator),r(2);break}}else if(Wt.test(e.slice(t)))u=o(0);else break t;e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==124&&(l=u,e.charCodeAt(t+1)===42?(u="*",t+=2):u=o(1)),i.push(u==="*"?{type:c.Universal,namespace:l}:{type:c.Tag,name:u,namespace:l})}}}return O(),t}var dt=n=>{for(;n.hasChildNodes();)n.firstChild.remove()},w=(n,e,t,i)=>n.addEventListener(e,t,i),Xt=(n,e,t,i)=>{e.forEach(o=>w(n,o,t,i))},h=(n,...e)=>{let[t]=lt(n).map(i=>i.reduce((o,r)=>{var d;return o===null&&r.type!=="tag"&&(o=document.createElement("div")),r.type==="tag"?document.createElement(r.name):(r.type==="attribute"&&r.name!=="class"&&o.setAttribute(r.name,(d=r.value)!=null?d:""),r.type==="attribute"&&r.name==="class"&&o.classList.add(r.value),o)},null));return e.forEach(i=>t.append(i)),t},f=n=>document.createTextNode(n),V,ht=class{constructor(e,...t){p(this,V,void 0);E(this,V,h(e,...t))}on(e,t,i){w(this.element(),e,t,i)}onEach(e,t,i){Xt(this.element(),e,t,i)}append(...e){return this.element().append(...e)}element(){return s(this,V)}empty(){dt(this.element())}};V=new WeakMap;var A=ht;var j,ut=class extends A{constructor(){super("span.letter");p(this,j,"")}hasValue(){return s(this,j)!==""}highlight(t){if(t===b.RIGHT){this.element().classList.add("right");return}if(t===b.WRONG_PLACE){this.element().classList.add("wrong-place");return}if(t===b.WRONG){this.element().classList.add("wrong");return}}setValue(t){E(this,j,t),this.empty(),this.append(f(t))}value(){return s(this,j)}};j=new WeakMap;var tt=ut;var M,B,pt=class extends A{constructor(t){super(".guess");p(this,M,[]);p(this,B,void 0);E(this,B,t);for(let i=0;i<t;i++)s(this,M).push(new tt);this.append(...s(this,M).map(i=>i.element()))}applyScore(t){s(this,M).forEach((i,o)=>i.highlight(t[o]))}clearError(){this.element().classList.remove("error")}guess(){return s(this,M).map(t=>t.value())}highlightError(){this.element().classList.add("error")}length(){return s(this,M).filter(t=>t.hasValue()).length}onInput(t){if(!(t==="Backspace"&&this.length()===0)){if(t==="Backspace"){this.clearError(),s(this,M)[this.length()-1].setValue("");return}this.length()!==s(this,B)&&s(this,M)[this.length()].setValue(t)}}};M=new WeakMap,B=new WeakMap;var Pt=pt;var H,U,ct=class extends A{constructor(t){super("section.guesses");p(this,H,void 0);p(this,U,[]);E(this,H,t),this.addGuess()}addGuess(){s(this,U).push(new Pt(s(this,H).currentWordLength())),this.append(this.currentGuess().element()),this.element().scrollTo({top:this.element().scrollHeight})}currentGuess(){return s(this,U)[s(this,U).length-1]}onInput(t){let i=this.currentGuess().guess(),o=this.currentGuess().length()===s(this,H).currentWordLength(),r=s(this,H).validate(i);if(t==="Enter"&&o&&r){let d=s(this,H).score(i);if(this.currentGuess().applyScore(d),d.every(m=>m===b.RIGHT))return;this.addGuess();return}t==="Enter"&&o&&!r&&this.currentGuess().highlightError(),t==="Backspace"&&this.currentGuess().onInput(t),t.match(/^[A-Z]$/i)&&this.currentGuess().onInput(t.toUpperCase())}};H=new WeakMap,U=new WeakMap;var kt=ct;var mt=class extends A{constructor(...e){super("dialog",...e),document.body.append(this.element())}close(){this.element().removeAttribute("open")}open(){this.element().setAttribute("open","")}},Kt=mt;var Rt=n=>n.setAttribute("hidden",""),xt=n=>n.removeAttribute("hidden"),ft=class extends Kt{constructor(e){super(h("h2",f("Options")));let t=h("select#mode",...St.map(a=>h(`option[value="${a}"]`+(a===e.mode()?"[selected]":""),f(I(a))))),i=h("select#theme",...rt.map(({label:a,path:l})=>h(`option[value="${l}"]`+(l===e.theme()?"[selected]":""),f(a)))),o=h("select#difficulty",...wt.map(a=>h(`option[value="${a}"]`+(a===e.difficulty()?"[selected]":""),f(z(a))))),r=h("fieldset",h('label[for="mode"][aria-label="Choose game mode"]',f("Game mode")),t),d=h("fieldset",h('label[for="mode"][aria-label="Choose theme"]'+(e.mode()!==T.THEMED?"[hidden]":""),f("Theme")),i),m=h("fieldset",h('label[for="difficulty"][aria-label="Choose difficulty"]'+(e.mode()!==T.THEMED?"[hidden]":""),f("Difficulty")),o),g=h("button",f("Apply")),y=a=>{if(e.setMode(a),a===T.THEMED){xt(m),xt(d);return}Rt(m),Rt(d)},v=a=>e.setTheme(a),O=a=>e.setDifficulty(a);w(t,"change",()=>y(parseInt(t.value))),w(i,"change",()=>v(i.value)),w(o,"change",()=>O(parseInt(o.value))),w(g,"click",()=>{e.start(),this.close()}),this.append(h("div",r,d,m,h("fieldset",g)))}},jt=ft;var Et=class extends A{constructor(e){super("nav.header",h("header",h("h1",f("Wordle Kids")),h("section.actions")),h("h3",f(`${I(e.mode())}${e.theme()?` (${Ct(e.theme())})`:""} - ${z(e.difficulty())}`)),h("p",f("A kid-friendly Wordle clone with small words and clues.")),h(".clues"));let t=this.element().querySelector(".clues"),i=new jt(e),o=this.element().querySelector("section.actions"),r=h('button[title="New game"]',f("\u21BB")),d=h('button[title="Get a hint"]',f("?")),m=h('button[title="Options"]',f("\u2699"));w(r,"click",()=>e.start()),w(d,"click",()=>{var v;let g=t.childNodes.length,y=(v=e.currentTarget().clues)!=null?v:[];g===y.length&&t.append(h("p",f("No more clues!"))),!(g>=y.length)&&t.append(h("p",f(y[g])))}),w(m,"click",()=>i.open()),o.append(r,d,m)}},Ut=Et;var $t={["Backspace"]:"\u232B"},q,Y,_,Q,gt=class extends A{constructor(t,i){super("section.keyboard[autofocus]");p(this,q,void 0);p(this,Y,void 0);p(this,_,{});p(this,Q,[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Backspace","Z","X","C","V","B","N","M","Enter"]]);this.append(...s(this,Q).map(o=>h("section.row",...o.map(r=>{var m;let d=new tt;return s(this,_)[r]=d,d.setValue(r),d.element().setAttribute("data-key",r),Object.prototype.hasOwnProperty.call($t,r)&&(d.empty(),d.append(f((m=$t[r])!=null?m:r))),d.on("click",()=>this.handleInput(r)),d.element()})))),E(this,Y,t),E(this,q,i),this.bindKeyboard()}bindKeyboard(){w(document,"keydown",t=>this.handleInput(t.key))}handleInput(t){s(this,Y).onInput(t),s(this,Q).flat().forEach(i=>{let o=s(this,_)[i],r=s(this,q).letterScore(i);o.highlight(r)})}};q=new WeakMap,Y=new WeakMap,_=new WeakMap,Q=new WeakMap;var Ft=gt;var N=new Dt(()=>{let n=new Ut(N),e=new kt(N),t=new Ft(e,N),i=document.getElementById("app");dt(i),i.append(n.element(),e.element(),t.element())});N.setDifficulty(J.EASY);N.setLengths(Tt);N.setMode(T.THEMED);N.setTheme("./lists/themes/animals.json");N.start();})();
//# sourceMappingURL=app.js.map
