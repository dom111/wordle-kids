(()=>{var rt=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var s=(r,e,t)=>(rt(r,e,"read from private field"),t?t.call(r):e.get(r)),p=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},l=(r,e,t,n)=>(rt(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);var j=(r,e,t)=>new Promise((n,a)=>{var i=g=>{try{f(t.next(g))}catch(b){a(b)}},m=g=>{try{f(t.throw(g))}catch(b){a(b)}},f=g=>g.done?n(g.value):Promise.resolve(g.value).then(i,m);f((t=t.apply(r,e)).next())});var u;(function(r){r.Attribute="attribute",r.Pseudo="pseudo",r.PseudoElement="pseudo-element",r.Tag="tag",r.Universal="universal",r.Adjacent="adjacent",r.Child="child",r.Descendant="descendant",r.Parent="parent",r.Sibling="sibling",r.ColumnCombinator="column-combinator"})(u||(u={}));var d;(function(r){r.Any="any",r.Element="element",r.End="end",r.Equals="equals",r.Exists="exists",r.Hyphen="hyphen",r.Not="not",r.Start="start"})(d||(d={}));var nt=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,dt=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,gt=new Map([[126,d.Element],[94,d.Start],[36,d.End],[42,d.Any],[33,d.Not],[124,d.Hyphen]]),Ct=new Set(["has","not","matches","is","where","host","host-context"]);function st(r){switch(r.type){case u.Adjacent:case u.Child:case u.Descendant:case u.Parent:case u.Sibling:case u.ColumnCombinator:return!0;default:return!1}}var Et=new Set(["contains","icontains"]);function wt(r,e,t){let n=parseInt(e,16)-65536;return n!==n||t?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function T(r){return r.replace(dt,wt)}function D(r){return r===39||r===34}function it(r){return r===32||r===9||r===10||r===12||r===13}function F(r){let e=[],t=at(e,`${r}`,0);if(t<r.length)throw new Error(`Unmatched selector: ${r.slice(t)}`);return e}function at(r,e,t){let n=[];function a(c){let o=e.slice(t+c).match(nt);if(!o)throw new Error(`Expected name, found ${e.slice(t)}`);let[h]=o;return t+=c+h.length,T(h)}function i(c){for(t+=c;t<e.length&&it(e.charCodeAt(t));)t++}function m(){t+=1;let c=t,o=1;for(;o>0&&t<e.length;t++)e.charCodeAt(t)===40&&!f(t)?o++:e.charCodeAt(t)===41&&!f(t)&&o--;if(o)throw new Error("Parenthesis not matched");return T(e.slice(c,t-1))}function f(c){let o=0;for(;e.charCodeAt(--c)===92;)o++;return(o&1)===1}function g(){if(n.length>0&&st(n[n.length-1]))throw new Error("Did not expect successive traversals.")}function b(c){if(n.length>0&&n[n.length-1].type===u.Descendant){n[n.length-1].type=c;return}g(),n.push({type:c})}function x(c,o){n.push({type:u.Attribute,name:c,action:o,value:a(1),namespace:null,ignoreCase:"quirks"})}function I(){if(n.length&&n[n.length-1].type===u.Descendant&&n.pop(),n.length===0)throw new Error("Empty sub-selector");r.push(n)}if(i(0),e.length===t)return t;t:for(;t<e.length;){let c=e.charCodeAt(t);switch(c){case 32:case 9:case 10:case 12:case 13:{(n.length===0||n[0].type!==u.Descendant)&&(g(),n.push({type:u.Descendant})),i(1);break}case 62:{b(u.Child),i(1);break}case 60:{b(u.Parent),i(1);break}case 126:{b(u.Sibling),i(1);break}case 43:{b(u.Adjacent),i(1);break}case 46:{x("class",d.Element);break}case 35:{x("id",d.Equals);break}case 91:{i(1);let o,h=null;e.charCodeAt(t)===124?o=a(1):e.startsWith("*|",t)?(h="*",o=a(2)):(o=a(0),e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==61&&(h=o,o=a(1))),i(0);let C=d.Exists,tt=gt.get(e.charCodeAt(t));if(tt){if(C=tt,e.charCodeAt(t+1)!==61)throw new Error("Expected `=`");i(2)}else e.charCodeAt(t)===61&&(C=d.Equals,i(1));let q="",V=null;if(C!=="exists"){if(D(e.charCodeAt(t))){let B=e.charCodeAt(t),v=t+1;for(;v<e.length&&(e.charCodeAt(v)!==B||f(v));)v+=1;if(e.charCodeAt(v)!==B)throw new Error("Attribute value didn't end");q=T(e.slice(t+1,v)),t=v+1}else{let B=t;for(;t<e.length&&(!it(e.charCodeAt(t))&&e.charCodeAt(t)!==93||f(t));)t+=1;q=T(e.slice(B,t))}i(0);let et=e.charCodeAt(t)|32;et===115?(V=!1,i(1)):et===105&&(V=!0,i(1))}if(e.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;let ft={type:u.Attribute,name:o,action:C,value:q,namespace:h,ignoreCase:V};n.push(ft);break}case 58:{if(e.charCodeAt(t+1)===58){n.push({type:u.PseudoElement,name:a(2).toLowerCase(),data:e.charCodeAt(t)===40?m():null});continue}let o=a(1).toLowerCase(),h=null;if(e.charCodeAt(t)===40)if(Ct.has(o)){if(D(e.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${o} cannot be quoted`);if(h=[],t=at(h,e,t+1),e.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${o} (${e})`);t+=1}else{if(h=m(),Et.has(o)){let C=h.charCodeAt(0);C===h.charCodeAt(h.length-1)&&D(C)&&(h=h.slice(1,-1))}h=T(h)}n.push({type:u.Pseudo,name:o,data:h});break}case 44:{I(),n=[],i(1);break}default:{if(e.startsWith("/*",t)){let C=e.indexOf("*/",t+2);if(C<0)throw new Error("Comment was not terminated");t=C+2,n.length===0&&i(0);break}let o=null,h;if(c===42)t+=1,h="*";else if(c===124){if(h="",e.charCodeAt(t+1)===124){b(u.ColumnCombinator),i(2);break}}else if(nt.test(e.slice(t)))h=a(0);else break t;e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==124&&(o=h,e.charCodeAt(t+1)===42?(h="*",t+=2):h=a(1)),n.push(h==="*"?{type:u.Universal,namespace:o}:{type:u.Tag,name:h,namespace:o})}}}return I(),t}var L=(r,...e)=>{let[t]=F(r).map(n=>n.reduce((a,i)=>{var m;if(a===null&&i.type!=="tag")throw new Error("Unexpected.");return i.type==="tag"?document.createElement(i.name):(i.type==="attribute"&&i.name!=="class"&&a.setAttribute(i.name,(m=i.value)!=null?m:""),i.type==="attribute"&&i.name==="class"&&a.classList.add(i.value),a)},null));return e.forEach(n=>t.append(n)),t},y=r=>document.createTextNode(r),k,$=class{constructor(e,...t){p(this,k,void 0);l(this,k,L(e,...t))}element(){return s(this,k)}empty(){this.element().childNodes.forEach(e=>e.remove())}};k=new WeakMap;var E=$;var N,_=class extends E{constructor(){super("span.letter");p(this,N,"")}hasValue(){return s(this,N)!==""}highlight(t){if(t===2){this.element().classList.add("right");return}if(t===1){this.element().classList.add("wrong-place");return}if(t===0){this.element().classList.add("wrong");return}}setValue(t){l(this,N,t),this.empty(),this.element().append(y(t))}value(){return s(this,N)}};N=new WeakMap;var M=_;var w,K,Q=class extends E{constructor(t){super("div.guess");p(this,w,[]);p(this,K,void 0);l(this,K,t);for(let n=0;n<t;n++)s(this,w).push(new M);this.element().append(...s(this,w).map(n=>n.element()))}applyScore(t){s(this,w).forEach((n,a)=>n.highlight(t[a]))}clearError(){this.element().classList.remove("error")}guess(){return s(this,w).map(t=>t.value())}highlightError(){this.element().classList.add("error")}length(){return s(this,w).filter(t=>t.hasValue()).length}onInput(t){if(!(t==="Backspace"&&this.length()===0)){if(t==="Backspace"){this.clearError(),s(this,w)[this.length()-1].setValue("");return}this.length()!==s(this,K)&&s(this,w)[this.length()].setValue(t)}}};w=new WeakMap,K=new WeakMap;var ht=Q;var A,W,Z=class extends E{constructor(t){super("section.guesses");p(this,A,void 0);p(this,W,[]);l(this,A,t),this.addGuess()}addGuess(){s(this,W).push(new ht(s(this,A).currentWordLength())),this.element().append(this.currentGuess().element()),this.element().scrollTo({top:this.element().scrollHeight})}currentGuess(){return s(this,W)[s(this,W).length-1]}onInput(t){let n=this.currentGuess().guess(),a=this.currentGuess().length()===s(this,A).currentWordLength(),i=s(this,A).validate(n);if(t==="Enter"&&a&&i){let m=s(this,A).score(n);if(this.currentGuess().applyScore(m),m.every(f=>f===2))return;this.addGuess();return}t==="Enter"&&a&&!i&&this.currentGuess().highlightError(),t==="Backspace"&&this.currentGuess().onInput(t),t.match(/^[A-Z]$/i)&&this.currentGuess().onInput(t.toUpperCase())}};A=new WeakMap,W=new WeakMap;var ut=Z;var z=class extends E{constructor(){super("nav",L("h1",y("Wordle Kids")),L("p",y("A kid-friendly Wordle clone with small words.")))}},pt=z;var mt={["Backspace"]:"\u232B"},R,O,H,U,J=class extends E{constructor(t,n){super("section.keyboard[autofocus]");p(this,R,void 0);p(this,O,void 0);p(this,H,{});p(this,U,[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Backspace","Z","X","C","V","B","N","M","Enter"]]);this.element().append(...s(this,U).map(a=>L("section.row",...a.map(i=>{var f;let m=new M;return s(this,H)[i]=m,m.setValue(i),m.element().setAttribute("data-key",i),Object.prototype.hasOwnProperty.call(mt,i)&&(m.empty(),m.element().append(y((f=mt[i])!=null?f:i))),m.element().addEventListener("click",()=>this.handleInput(i)),m.element()})))),l(this,O,t),l(this,R,n),this.bindKeyboard()}bindKeyboard(){document.addEventListener("keydown",t=>this.handleInput(t.key))}handleInput(t){s(this,O).onInput(t),s(this,U).flat().forEach(n=>{let a=s(this,H)[n],i=s(this,R).letterScore(n);a.highlight(i)})}};R=new WeakMap,O=new WeakMap,H=new WeakMap,U=new WeakMap;var ct=J;var P,S,G,X=class{constructor(){p(this,P,void 0);p(this,S,{});p(this,G,[])}currentWordLength(){return s(this,P).length}getWordlist(){return j(this,null,function*(){return(yield(yield fetch("./lists/3-letter.json")).json()).map(t=>t.toUpperCase())})}init(){return j(this,null,function*(){l(this,G,yield this.getWordlist()),this.setCurrentWord()})}letterScore(e){var t;return(t=s(this,S)[e])!=null?t:-1}score(e){let t=[...s(this,P)];return t.reduce((n,a,i)=>(a===e[i]&&(s(this,S)[a]=n[i]=2,t[i]=null),n),new Array(this.currentWordLength()).fill(-1)).map((n,a)=>{if(n===2)return n;let i=t.indexOf(e[a]);return i>-1?(t[i]=null,s(this,S)[e[a]]=1):s(this,S)[e[a]]=0})}setCurrentWord(){l(this,P,[...s(this,G)[Math.floor(s(this,G).length*Math.random())].toUpperCase()])}validate(e){return s(this,G).includes(e.join(""))}};P=new WeakMap,S=new WeakMap,G=new WeakMap;var lt=X;var Y=new lt;Y.init().then(()=>{let r=new pt,e=new ut(Y),t=new ct(e,Y);document.getElementById("app").append(r.element(),e.element(),t.element())});})();
//# sourceMappingURL=app.js.map
