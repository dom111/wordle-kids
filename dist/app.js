(()=>{var Vt=Object.create;var dt=Object.defineProperty;var Mt=Object.getOwnPropertyDescriptor;var Lt=Object.getOwnPropertyNames;var Yt=Object.getPrototypeOf,Ht=Object.prototype.hasOwnProperty;var zt=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var kt=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Lt(t))!Ht.call(i,n)&&n!==e&&dt(i,n,{get:()=>t[n],enumerable:!(s=Mt(t,n))||s.enumerable});return i};var v=(i,t,e)=>(e=i!=null?Vt(Yt(i)):{},kt(t||!i||!i.__esModule?dt(e,"default",{value:i,enumerable:!0}):e,i));var y=zt(r=>{"use strict";var U,Pt=r&&r.__classPrivateFieldSet||function(i,t,e,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(i,e):n?n.value=e:t.set(i,e),e},Kt=r&&r.__classPrivateFieldGet||function(i,t,e,s){if(e==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!s:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?s:e==="a"?s.call(i):s?s.value:t.get(i)};Object.defineProperty(r,"__esModule",{value:!0}),r.Element=r.toggleClass=r.t=r.s=r.removeClass=r.once=r.onEach=r.on=r.off=r.hasClass=r.empty=r.emitCustom=r.emit=r.addClass=void 0;r.addClass=(i,...t)=>i.classList.add(...t);r.emit=(i,t)=>i.dispatchEvent(t);r.emitCustom=(i,t,...e)=>(0,r.emit)(i,new CustomEvent(t,{detail:e}));r.empty=i=>{for(var t;i.hasChildNodes();)(t=i.firstChild)===null||t===void 0||t.remove()};r.hasClass=(i,t)=>i.classList.contains(t);r.off=(i,t,e,s={})=>i.removeEventListener(t,e,s);r.on=(i,t,e,s={})=>i.addEventListener(t,e,s);r.onEach=(i,t,e,s={})=>t.forEach((n=>(0,r.on)(i,n,e,s)));r.once=(i,t,e,s={})=>(0,r.on)(i,t,e,Object.assign(Object.assign({},typeof s=="boolean"?{capture:s}:s),{once:!0}));r.removeClass=(i,...t)=>i.classList.remove(...t);r.s=(i,...t)=>{let e=document.createElement("div");e.innerHTML=i;let s=e.firstElementChild;return t.forEach((n=>{n instanceof x?s.append(n.element()):n instanceof Node?s.append(n):s.append((0,r.t)(n))})),s};r.t=i=>document.createTextNode(i);r.toggleClass=(i,...t)=>t.forEach((e=>i.classList.toggle(e)));var x=class i{constructor(t){U.set(this,void 0),Pt(this,U,t,"f")}static fromString(t){return new i((0,r.s)(t))}addClass(...t){(0,r.addClass)(this.element(),...t)}append(...t){t.forEach((e=>{e instanceof i&&(e=e.element()),this.element().append(e)}))}element(){return Kt(this,U,"f")}emit(t){return(0,r.emit)(this.element(),t)}emitCustom(t,...e){return(0,r.emitCustom)(this.element(),t,...e)}empty(){(0,r.empty)(this.element())}hasClass(t){return(0,r.hasClass)(this.element(),t)}off(t,e,s={}){(0,r.off)(this.element(),t,e,s)}on(t,e,s={}){(0,r.on)(this.element(),t,e,s)}onEach(t,e,s={}){(0,r.onEach)(this.element(),t,e,s)}once(t,e,s={}){(0,r.once)(this.element(),t,e,s)}query(t){return this.element().querySelector(t)}queryAll(t){return this.element().querySelectorAll(t)}remove(){this.element().remove()}removeClass(...t){(0,r.removeClass)(this.element(),...t)}toggleClass(...t){(0,r.toggleClass)(this.element(),...t)}};r.Element=x,U=new WeakMap,r.default=x});var ut=(s=>(s[s.EASY=0]="EASY",s[s.NORMAL=1]="NORMAL",s[s.HARD=2]="HARD",s))(ut||{}),k=[0,1,2],jt={0:"Easy",1:"Normal",2:"Hard"},W=i=>jt[i]??"Invalid",ht=i=>{let t=parseInt(i);if(!k.includes(t))throw new TypeError(`Invalid Difficulty: ${i}`);return t},N=ut;var gt=(n=>(n[n.UNKNOWN=-1]="UNKNOWN",n[n.WRONG=0]="WRONG",n[n.WRONG_PLACE=1]="WRONG_PLACE",n[n.RIGHT=2]="RIGHT",n))(gt||{}),I=gt;var j=class extends TypeError{},T=j;var S=[{label:"Animals",path:"./lists/themes/animals.json"}],J=i=>{let[t]=S.filter(e=>e.path===i);if(!t)throw new T(`Unknown theme '${i}'.`);return t},pt=i=>J(i).label??"Unknown";var bt=[3,4,5],St={3:"./lists/3-letter.json",4:"./lists/4-letter.json",5:"./lists/5-letter.json"},P=new Map,ft=i=>(P.has(i)||P.set(i,fetch(St[i]).then(t=>t.json())),P.get(i));var Ct=(e=>(e[e.FREE_PLAY=0]="FREE_PLAY",e[e.THEMED=1]="THEMED",e))(Ct||{}),K=[0,1],Jt={0:"Free Play",1:"Themed"},X=i=>Jt[i]??"Invalid",It=i=>{let t=parseInt(i);if(!K.includes(t))throw new TypeError(`Invalid Mode: ${i}`);return t},A=Ct;var q=class{#t;#e=N.EASY;#i;#s={};#o;#a;#r="";#n=[];constructor(t){this.#a=t}async addAllValidWords(t){await Promise.all(t.map(e=>this.addValidWords(e)))}async addValidWords(t){(await ft(t)).forEach(s=>this.#n.push(s.toUpperCase()))}currentTarget(){return this.#t}currentWordLength(){return this.#t.word.length}difficulty(){return this.#e}letterScore(t){return this.#s[t]??I.UNKNOWN}mode(){return this.#o}score(t){let e=[...this.#t.word];return e.reduce((s,n,o)=>(n===t[o]&&(this.#s[n]=s[o]=I.RIGHT,e[o]=null),s),new Array(this.currentWordLength()).fill(I.UNKNOWN)).map((s,n)=>{if(s===I.RIGHT)return s;let o=e.indexOf(t[n]);return o>-1?(e[o]=null,this.#s[t[n]]=I.WRONG_PLACE):this.#s[t[n]]=I.WRONG})}setDifficulty(t){this.#e=t}async setFreePlay(t){await this.addAllValidWords(t);let e=this.#n[Math.floor(this.#n.length*Math.random())].toUpperCase();this.#t={word:e,difficulty:0,clues:[]}}setLengths(t){this.#i=t}setMode(t){this.#o=t}async setThemedGame(t,e){let s=J(t);this.#r=t;let o=(await(await fetch(s.path)).json()).words.filter(u=>u.difficulty<=e),g=o.reduce((u,{word:R})=>(u.includes(R.length)||u.push(R.length),u),[]);await this.addAllValidWords(g),o.map(({word:u})=>u.toUpperCase()).forEach(u=>{this.#n.includes(u)||this.#n.push(u)});let{word:f,difficulty:h,clues:C}=o[Math.floor(o.length*Math.random())];this.#t={word:f.toUpperCase(),difficulty:h,clues:C}}setTheme(t){this.#r=t}async start(){if(this.#o===A.THEMED&&!this.#r)throw new T("Expected `theme` when using `Mode.THEMED`.");if(this.#s={},this.#o===A.THEMED){await this.setThemedGame(this.#r,this.#e),this.#a();return}if(this.#o===A.FREE_PLAY){await this.setFreePlay(this.#i),this.#a();return}}theme(){return this.#r}validate(t){return this.#n.includes(t.join(""))}},Gt=q;var Q=v(y());var wt=v(y());var V=v(y());var d;(function(i){i.Attribute="attribute",i.Pseudo="pseudo",i.PseudoElement="pseudo-element",i.Tag="tag",i.Universal="universal",i.Adjacent="adjacent",i.Child="child",i.Descendant="descendant",i.Parent="parent",i.Sibling="sibling",i.ColumnCombinator="column-combinator"})(d||(d={}));var G;(function(i){i.Any="any",i.Element="element",i.End="end",i.Equals="equals",i.Exists="exists",i.Hyphen="hyphen",i.Not="not",i.Start="start"})(G||(G={}));var At=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,qt=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,$t=new Map([[126,G.Element],[94,G.Start],[36,G.End],[42,G.Any],[33,G.Not],[124,G.Hyphen]]),_t=new Set(["has","not","matches","is","where","host","host-context"]);function Bt(i){switch(i.type){case d.Adjacent:case d.Child:case d.Descendant:case d.Parent:case d.Sibling:case d.ColumnCombinator:return!0;default:return!1}}var te=new Set(["contains","icontains"]);function ee(i,t,e){let s=parseInt(t,16)-65536;return s!==s||e?t:s<0?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,s&1023|56320)}function Z(i){return i.replace(qt,ee)}function $(i){return i===39||i===34}function yt(i){return i===32||i===9||i===10||i===12||i===13}function _(i){let t=[],e=vt(t,`${i}`,0);if(e<i.length)throw new Error(`Unmatched selector: ${i.slice(e)}`);return t}function vt(i,t,e){let s=[];function n(l){let c=t.slice(e+l).match(At);if(!c)throw new Error(`Expected name, found ${t.slice(e)}`);let[m]=c;return e+=l+m.length,Z(m)}function o(l){for(e+=l;e<t.length&&yt(t.charCodeAt(e));)e++}function g(){e+=1;let l=e,c=1;for(;c>0&&e<t.length;e++)t.charCodeAt(e)===40&&!f(e)?c++:t.charCodeAt(e)===41&&!f(e)&&c--;if(c)throw new Error("Parenthesis not matched");return Z(t.slice(l,e-1))}function f(l){let c=0;for(;t.charCodeAt(--l)===92;)c++;return(c&1)===1}function h(){if(s.length>0&&Bt(s[s.length-1]))throw new Error("Did not expect successive traversals.")}function C(l){if(s.length>0&&s[s.length-1].type===d.Descendant){s[s.length-1].type=l;return}h(),s.push({type:l})}function u(l,c){s.push({type:d.Attribute,name:l,action:c,value:n(1),namespace:null,ignoreCase:"quirks"})}function R(){if(s.length&&s[s.length-1].type===d.Descendant&&s.pop(),s.length===0)throw new Error("Empty sub-selector");i.push(s)}if(o(0),t.length===e)return e;t:for(;e<t.length;){let l=t.charCodeAt(e);switch(l){case 32:case 9:case 10:case 12:case 13:{(s.length===0||s[0].type!==d.Descendant)&&(h(),s.push({type:d.Descendant})),o(1);break}case 62:{C(d.Child),o(1);break}case 60:{C(d.Parent),o(1);break}case 126:{C(d.Sibling),o(1);break}case 43:{C(d.Adjacent),o(1);break}case 46:{u("class",G.Element);break}case 35:{u("id",G.Equals);break}case 91:{o(1);let c,m=null;t.charCodeAt(e)===124?c=n(1):t.startsWith("*|",e)?(m="*",c=n(2)):(c=n(0),t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==61&&(m=c,c=n(1))),o(0);let B=G.Exists,ct=$t.get(t.charCodeAt(e));if(ct){if(B=ct,t.charCodeAt(e+1)!==61)throw new Error("Expected `=`");o(2)}else t.charCodeAt(e)===61&&(B=G.Equals,o(1));let H="",z=null;if(B!=="exists"){if($(t.charCodeAt(e))){let D=t.charCodeAt(e),O=e+1;for(;O<t.length&&(t.charCodeAt(O)!==D||f(O));)O+=1;if(t.charCodeAt(O)!==D)throw new Error("Attribute value didn't end");H=Z(t.slice(e+1,O)),e=O+1}else{let D=e;for(;e<t.length&&(!yt(t.charCodeAt(e))&&t.charCodeAt(e)!==93||f(e));)e+=1;H=Z(t.slice(D,e))}o(0);let mt=t.charCodeAt(e)|32;mt===115?(z=!1,o(1)):mt===105&&(z=!0,o(1))}if(t.charCodeAt(e)!==93)throw new Error("Attribute selector didn't terminate");e+=1;let Ut={type:d.Attribute,name:c,action:B,value:H,namespace:m,ignoreCase:z};s.push(Ut);break}case 58:{if(t.charCodeAt(e+1)===58){s.push({type:d.PseudoElement,name:n(2).toLowerCase(),data:t.charCodeAt(e)===40?g():null});continue}let c=n(1).toLowerCase(),m=null;if(t.charCodeAt(e)===40)if(_t.has(c)){if($(t.charCodeAt(e+1)))throw new Error(`Pseudo-selector ${c} cannot be quoted`);if(m=[],e=vt(m,t,e+1),t.charCodeAt(e)!==41)throw new Error(`Missing closing parenthesis in :${c} (${t})`);e+=1}else{if(m=g(),te.has(c)){let B=m.charCodeAt(0);B===m.charCodeAt(m.length-1)&&$(B)&&(m=m.slice(1,-1))}m=Z(m)}s.push({type:d.Pseudo,name:c,data:m});break}case 44:{R(),s=[],o(1);break}default:{if(t.startsWith("/*",e)){let B=t.indexOf("*/",e+2);if(B<0)throw new Error("Comment was not terminated");e=B+2,s.length===0&&o(0);break}let c=null,m;if(l===42)e+=1,m="*";else if(l===124){if(m="",t.charCodeAt(e+1)===124){C(d.ColumnCombinator),o(2);break}}else if(At.test(t.slice(e)))m=n(0);else break t;t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==124&&(c=m,t.charCodeAt(e+1)===42?(m="*",e+=2):m=n(1)),s.push(m==="*"?{type:d.Universal,namespace:c}:{type:d.Tag,name:m,namespace:c})}}}return R(),e}var a=(i,...t)=>{let[e]=_(i).map(s=>s.reduce((n,o)=>(n===null&&o.type!=="tag"&&(n=document.createElement("div")),o.type==="tag"?document.createElement(o.name):(o.type==="attribute"&&o.name!=="class"&&n.setAttribute(o.name,o.value??""),o.type==="attribute"&&o.name==="class"&&n.classList.add(o.value),n)),null));return t.forEach(s=>e.append(s)),e};var tt=class extends V.default{#t="";constructor(){super(a('span.letter[tabindex="-1"]'))}hasValue(){return this.#t!==""}highlight(t){if(t===I.RIGHT){this.element().classList.add("right");return}if(t===I.WRONG_PLACE){this.element().classList.add("wrong-place");return}if(t===I.WRONG){this.element().classList.add("wrong");return}}setValue(t){this.#t=t,this.empty(),this.append((0,V.t)(t))}value(){return this.#t}},M=tt;var et=class extends wt.default{#t=[];#e;constructor(t){super(a(".guess")),this.#e=t;for(let e=0;e<t;e++)this.#t.push(new M);this.append(...this.#t.map(e=>e.element()))}applyScore(t){this.#t.forEach((e,s)=>e.highlight(t[s]))}celebrate(){this.addClass("dance")}clearError(){this.element().classList.remove("error")}guess(){return this.#t.map(t=>t.value())}highlightError(){this.element().classList.add("error")}length(){return this.#t.filter(t=>t.hasValue()).length}onInput(t){if(!(t==="Backspace"&&this.length()===0)){if(t==="Backspace"){this.clearError(),this.#t[this.length()-1].setValue("");return}this.length()!==this.#e&&this.#t[this.length()].setValue(t)}}},Et=et;var it=class extends Q.default{#t=!1;#e;#i=[];constructor(t){super(a('section.guesses[tabindex="0"][aria-label="Enter your guess"][autofocus]')),this.#e=t,this.addGuess(),this.bindEvents()}addGuess(){this.#i.push(new Et(this.#e.currentWordLength())),this.append(this.currentGuess().element()),this.scrollToBottom()}bindEvents(){new ResizeObserver(()=>this.scrollToBottom()).observe(this.element())}currentGuess(){return this.#i[this.#i.length-1]}onInput(t){if(this.#t)return;let e=this.currentGuess().guess(),s=this.currentGuess().length()===this.#e.currentWordLength(),n=this.#e.validate(e);if(t==="Enter"&&s&&n){let o=this.#e.score(e);if(this.currentGuess().applyScore(o),o.every(g=>g===I.RIGHT)){this.#t=!0,this.currentGuess().celebrate(),(0,Q.emit)(this.element().ownerDocument,new CustomEvent("complete"));return}this.addGuess(),(0,Q.emit)(this.element().ownerDocument,new CustomEvent("incorrect-guess",{detail:{guesses:this.#i.length-1}}));return}t==="Enter"&&s&&!n&&this.currentGuess().highlightError(),t==="Backspace"&&this.currentGuess().onInput(t),t.match(/^[A-Z]$/i)&&this.currentGuess().onInput(t.toUpperCase())}scrollToBottom(){requestAnimationFrame(()=>this.element().scrollTo({top:this.element().scrollHeight}))}},Rt=it;var b=v(y());var p=v(y());var Ot=v(y());var st=class extends Ot.default{#t;constructor(...t){super(a('dialog[tabindex="0"]')),this.#t=a(".content",...t),this.element().append(this.#t),document.body.append(this.element()),this.bindEvents()}append(...t){this.#t.append(...t)}bindEvents(){this.on("click",t=>{t.target===this.element()&&this.close()}),this.on("keydown",t=>{t.key==="Escape"&&this.close()})}close(){this.element().removeAttribute("open")}open(){this.element().setAttribute("open",""),this.element().focus()}setLabel(t){this.element().setAttribute("aria-label",t)}},Ft=st;var xt=i=>i.setAttribute("hidden",""),Zt=i=>i.removeAttribute("hidden"),nt=class extends Ft{constructor(t){super(a("h2",(0,p.t)("Options"))),this.addClass("options"),this.setLabel("Options dialog. Close with Escape key");let e=a("select#mode",...K.map(l=>a(`option[value="${l}"]`+(l===t.mode()?"[selected]":""),(0,p.t)(X(l))))),s=a("select#theme",...S.map(({label:l,path:c})=>a(`option[value="${c}"]`+(c===t.theme()?"[selected]":""),(0,p.t)(l)))),n=a("select#difficulty",...k.map(l=>a(`option[value="${l}"]`+(l===t.difficulty()?"[selected]":""),(0,p.t)(W(l))))),o=a("fieldset",a('label[for="mode"][aria-label="Choose game mode"]',(0,p.t)("Game mode")),e),g=a("fieldset"+(t.mode()!==A.THEMED?"[hidden]":""),a('label[for="mode"][aria-label="Choose theme"]',(0,p.t)("Theme")),s),f=a("fieldset"+(t.mode()!==A.THEMED?"[hidden]":""),a('label[for="difficulty"][aria-label="Choose difficulty"]',(0,p.t)("Difficulty")),n),h=a("button",(0,p.t)("Apply")),C=l=>{if(l=It(l),t.setMode(l),l===A.THEMED){Zt(f),Zt(g);return}xt(f),xt(g)},u=l=>t.setTheme(l),R=l=>t.setDifficulty(ht(l));(0,p.on)(e,"change",()=>C(e.value)),(0,p.on)(s,"change",()=>u(s.value)),(0,p.on)(n,"change",()=>R(n.value)),(0,p.on)(h,"click",()=>{t.start(),this.close()}),this.append(a("div",o,g,f,a("fieldset",h)))}},Qt=nt;var L=v(y());var w=v(y());var ot=class extends w.default{#t;#e;constructor(t,e){super(a("div.tooltip")),this.#t=t,this.#e=e,this.append((0,w.t)(this.#t)),this.bindEvents()}bindEvents(){(0,w.on)(this.#e,"mouseenter",()=>this.show()),(0,w.on)(this.#e,"mouseleave",()=>this.hide()),(0,w.on)(this.element().ownerDocument,"new-game",()=>this.remove())}hide(){this.removeClass("show")}position(){this.element().style.setProperty("top",`${this.#e.offsetTop+this.#e.offsetHeight+10}px`);let t=Math.max(0,Math.min(this.#e.offsetLeft+this.#e.offsetWidth/2-this.element().offsetWidth/2,window.innerWidth-this.element().offsetWidth));this.element().style.setProperty("left",`${t}px`)}show(){this.addClass("show"),requestAnimationFrame(()=>this.position())}},Dt=ot;var rt=class extends L.default{constructor(t,e){super(a("button.button",(0,L.t)(t)));let s=new Dt(e,this.element());this.element().ownerDocument.body.append(s.element()),this.on("click",()=>this.element().blur())}},Y=rt;var at=class extends b.default{constructor(t){super(a("nav.header",a("header",a("h1",(0,b.t)("Wordle Kids")),a("section.actions")),a("h3",(0,b.t)(X(t.mode())+(t.mode()===A.THEMED?` (${pt(t.theme())}) - ${W(t.difficulty())}`:""))),a("p",(0,b.t)("A kid-friendly Wordle clone with small words and clues.")),a(".clues")));let e=this.element().querySelector(".clues"),s=new Qt(t),n=new b.default(this.element().querySelector("section.actions")),o=new Y("\u21BB","New game"),g=new Y("?","Get a hint"),f=new Y("\u2699","Options");o.on("click",h=>{t.start(),h.preventDefault(),h.stopPropagation(),(0,b.emit)(this.element().ownerDocument,new CustomEvent("new-game"))}),g.on("click",h=>{let C=e.childNodes.length,u=t.currentTarget().clues??[];h.preventDefault(),h.stopPropagation(),C===u.length&&e.append(a(".clue.no-more",(0,b.t)("No more clues!"))),!(C>=u.length)&&e.append(a(".clue",(0,b.t)(u[C])))}),f.on("click",h=>{s.open(),h.preventDefault(),h.stopPropagation()}),n.append(o,g,f),(0,b.on)(this.element().ownerDocument,"incorrect-guess",({detail:h})=>{h.guesses>2&&g.addClass("highlight")}),(0,b.on)(this.element().ownerDocument,"complete",()=>{o.addClass("highlight"),g.removeClass("highlight")})}},Wt=at;var F=v(y());var Nt={Backspace:"\u232B"},lt=class extends F.default{#t;#e;#i={};#s=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Backspace","Z","X","C","V","B","N","M","Enter"]];constructor(t,e){super(a("section.keyboard[autofocus]")),this.append(...this.#s.map(s=>a("section.row",...s.map(n=>{let o=new M;return this.#i[n]=o,o.setValue(n),o.element().setAttribute("data-key",n),Object.prototype.hasOwnProperty.call(Nt,n)&&(o.empty(),o.append((0,F.t)(Nt[n]??n))),o.on("click",()=>this.handleInput(n)),o.element()})))),this.#e=t,this.#t=e,this.bindKeyboard()}bindKeyboard(){(0,F.on)(document,"keydown",t=>this.handleInput(t.key))}handleInput(t){this.#e.onInput(t),this.#s.flat().forEach(e=>{let s=this.#i[e],n=this.#t.letterScore(e);s.highlight(n)})}},Tt=lt;var Xt=v(y());var E=new Gt(()=>{let i=new Wt(E),t=new Rt(E),e=new Tt(t,E),s=document.getElementById("app");(0,Xt.empty)(s),s.append(i.element(),t.element(),e.element())});E.setDifficulty(N.EASY);E.setLengths(bt);E.setMode(A.THEMED);E.setTheme("./lists/themes/animals.json");E.start();})();
//# sourceMappingURL=app.js.map
