(()=>{var et=(n=>(n[n.EASY=0]="EASY",n[n.NORMAL=1]="NORMAL",n[n.HARD=2]="HARD",n))(et||{}),R=[0,1,2],Et={0:"Easy",1:"Normal",2:"Hard"},W=i=>Et[i]??"Invalid",it=i=>{let t=parseInt(i);if(!R.includes(t))throw new TypeError(`Invalid Difficulty: ${i}`);return t},w=et;var nt=(s=>(s[s.UNKNOWN=-1]="UNKNOWN",s[s.WRONG=0]="WRONG",s[s.WRONG_PLACE=1]="WRONG_PLACE",s[s.RIGHT=2]="RIGHT",s))(nt||{}),f=nt;var X=class extends TypeError{},Z=X;var Q=[{label:"Animals",path:"./lists/themes/animals.json"}],V=i=>{let[t]=Q.filter(e=>e.path===i);if(!t)throw new Z(`Unknown theme '${i}'.`);return t},rt=i=>V(i).label??"Unknown";var st=[3,4,5],Bt={3:"./lists/3-letter.json",4:"./lists/4-letter.json",5:"./lists/5-letter.json"},T=new Map,ot=i=>(T.has(i)||T.set(i,fetch(Bt[i]).then(t=>t.json())),T.get(i));var at=(e=>(e[e.FREE_PLAY=0]="FREE_PLAY",e[e.THEMED=1]="THEMED",e))(at||{}),M=[0,1],xt={0:"Free Play",1:"Themed"},F=i=>xt[i]??"Invalid",lt=i=>{let t=parseInt(i);if(!M.includes(t))throw new TypeError(`Invalid Mode: ${i}`);return t},G=at;var U=class{#t;#e=w.EASY;#i;#n={};#s;#a;#o="";#r=[];constructor(t){this.#a=t}async addAllValidWords(t){await Promise.all(t.map(e=>this.addValidWords(e)))}async addValidWords(t){(await ot(t)).forEach(n=>this.#r.push(n.toUpperCase()))}currentTarget(){return this.#t}currentWordLength(){return this.#t.word.length}difficulty(){return this.#e}letterScore(t){return this.#n[t]??f.UNKNOWN}mode(){return this.#s}score(t){let e=[...this.#t.word];return e.reduce((n,s,r)=>(s===t[r]&&(this.#n[s]=n[r]=f.RIGHT,e[r]=null),n),new Array(this.currentWordLength()).fill(f.UNKNOWN)).map((n,s)=>{if(n===f.RIGHT)return n;let r=e.indexOf(t[s]);return r>-1?(e[r]=null,this.#n[t[s]]=f.WRONG_PLACE):this.#n[t[s]]=f.WRONG})}setDifficulty(t){this.#e=t}async setFreePlay(t){await this.addAllValidWords(t);let e=this.#r[Math.floor(this.#r.length*Math.random())].toUpperCase();this.#t={word:e,difficulty:0,clues:[]}}setLengths(t){this.#i=t}setMode(t){this.#s=t}async setThemedGame(t,e){let n=V(t);this.#o=t;let r=(await(await fetch(n.path)).json()).words.filter(h=>h.difficulty<=e),m=r.reduce((h,{word:E})=>(h.includes(E.length)||h.push(E.length),h),[]);await this.addAllValidWords(m),r.map(({word:h})=>h.toUpperCase()).forEach(h=>{this.#r.includes(h)||this.#r.push(h)});let{word:p,difficulty:g,clues:b}=r[Math.floor(r.length*Math.random())];this.#t={word:p.toUpperCase(),difficulty:g,clues:b}}setTheme(t){this.#o=t}async start(){if(this.#s===G.THEMED&&!this.#o)throw new Z("Expected `theme` when using `Mode.THEMED`.");if(this.#n={},this.#s===G.THEMED){await this.setThemedGame(this.#o,this.#e),this.#a();return}if(this.#s===G.FREE_PLAY){await this.setFreePlay(this.#i),this.#a();return}}theme(){return this.#o}validate(t){return this.#r.includes(t.join(""))}},dt=U;var c;(function(i){i.Attribute="attribute",i.Pseudo="pseudo",i.PseudoElement="pseudo-element",i.Tag="tag",i.Universal="universal",i.Adjacent="adjacent",i.Child="child",i.Descendant="descendant",i.Parent="parent",i.Sibling="sibling",i.ColumnCombinator="column-combinator"})(c||(c={}));var A;(function(i){i.Any="any",i.Element="element",i.End="end",i.Equals="equals",i.Exists="exists",i.Hyphen="hyphen",i.Not="not",i.Start="start"})(A||(A={}));var ct=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,Ot=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,Wt=new Map([[126,A.Element],[94,A.Start],[36,A.End],[42,A.Any],[33,A.Not],[124,A.Hyphen]]),wt=new Set(["has","not","matches","is","where","host","host-context"]);function ht(i){switch(i.type){case c.Adjacent:case c.Child:case c.Descendant:case c.Parent:case c.Sibling:case c.ColumnCombinator:return!0;default:return!1}}var Zt=new Set(["contains","icontains"]);function Ft(i,t,e){let n=parseInt(t,16)-65536;return n!==n||e?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function x(i){return i.replace(Ot,Ft)}function k(i){return i===39||i===34}function ut(i){return i===32||i===9||i===10||i===12||i===13}function H(i){let t=[],e=gt(t,`${i}`,0);if(e<i.length)throw new Error(`Unmatched selector: ${i.slice(e)}`);return t}function gt(i,t,e){let n=[];function s(o){let l=t.slice(e+o).match(ct);if(!l)throw new Error(`Expected name, found ${t.slice(e)}`);let[d]=l;return e+=o+d.length,x(d)}function r(o){for(e+=o;e<t.length&&ut(t.charCodeAt(e));)e++}function m(){e+=1;let o=e,l=1;for(;l>0&&e<t.length;e++)t.charCodeAt(e)===40&&!p(e)?l++:t.charCodeAt(e)===41&&!p(e)&&l--;if(l)throw new Error("Parenthesis not matched");return x(t.slice(o,e-1))}function p(o){let l=0;for(;t.charCodeAt(--o)===92;)l++;return(l&1)===1}function g(){if(n.length>0&&ht(n[n.length-1]))throw new Error("Did not expect successive traversals.")}function b(o){if(n.length>0&&n[n.length-1].type===c.Descendant){n[n.length-1].type=o;return}g(),n.push({type:o})}function h(o,l){n.push({type:c.Attribute,name:o,action:l,value:s(1),namespace:null,ignoreCase:"quirks"})}function E(){if(n.length&&n[n.length-1].type===c.Descendant&&n.pop(),n.length===0)throw new Error("Empty sub-selector");i.push(n)}if(r(0),t.length===e)return e;t:for(;e<t.length;){let o=t.charCodeAt(e);switch(o){case 32:case 9:case 10:case 12:case 13:{(n.length===0||n[0].type!==c.Descendant)&&(g(),n.push({type:c.Descendant})),r(1);break}case 62:{b(c.Child),r(1);break}case 60:{b(c.Parent),r(1);break}case 126:{b(c.Sibling),r(1);break}case 43:{b(c.Adjacent),r(1);break}case 46:{h("class",A.Element);break}case 35:{h("id",A.Equals);break}case 91:{r(1);let l,d=null;t.charCodeAt(e)===124?l=s(1):t.startsWith("*|",e)?(d="*",l=s(2)):(l=s(0),t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==61&&(d=l,l=s(1))),r(0);let v=A.Exists,_=Wt.get(t.charCodeAt(e));if(_){if(v=_,t.charCodeAt(e+1)!==61)throw new Error("Expected `=`");r(2)}else t.charCodeAt(e)===61&&(v=A.Equals,r(1));let N="",D=null;if(v!=="exists"){if(k(t.charCodeAt(e))){let O=t.charCodeAt(e),B=e+1;for(;B<t.length&&(t.charCodeAt(B)!==O||p(B));)B+=1;if(t.charCodeAt(B)!==O)throw new Error("Attribute value didn't end");N=x(t.slice(e+1,B)),e=B+1}else{let O=e;for(;e<t.length&&(!ut(t.charCodeAt(e))&&t.charCodeAt(e)!==93||p(e));)e+=1;N=x(t.slice(O,e))}r(0);let tt=t.charCodeAt(e)|32;tt===115?(D=!1,r(1)):tt===105&&(D=!0,r(1))}if(t.charCodeAt(e)!==93)throw new Error("Attribute selector didn't terminate");e+=1;let yt={type:c.Attribute,name:l,action:v,value:N,namespace:d,ignoreCase:D};n.push(yt);break}case 58:{if(t.charCodeAt(e+1)===58){n.push({type:c.PseudoElement,name:s(2).toLowerCase(),data:t.charCodeAt(e)===40?m():null});continue}let l=s(1).toLowerCase(),d=null;if(t.charCodeAt(e)===40)if(wt.has(l)){if(k(t.charCodeAt(e+1)))throw new Error(`Pseudo-selector ${l} cannot be quoted`);if(d=[],e=gt(d,t,e+1),t.charCodeAt(e)!==41)throw new Error(`Missing closing parenthesis in :${l} (${t})`);e+=1}else{if(d=m(),Zt.has(l)){let v=d.charCodeAt(0);v===d.charCodeAt(d.length-1)&&k(v)&&(d=d.slice(1,-1))}d=x(d)}n.push({type:c.Pseudo,name:l,data:d});break}case 44:{E(),n=[],r(1);break}default:{if(t.startsWith("/*",e)){let v=t.indexOf("*/",e+2);if(v<0)throw new Error("Comment was not terminated");e=v+2,n.length===0&&r(0);break}let l=null,d;if(o===42)e+=1,d="*";else if(o===124){if(d="",t.charCodeAt(e+1)===124){b(c.ColumnCombinator),r(2);break}}else if(ct.test(t.slice(e)))d=s(0);else break t;t.charCodeAt(e)===124&&t.charCodeAt(e+1)!==124&&(l=d,t.charCodeAt(e+1)===42?(d="*",e+=2):d=s(1)),n.push(d==="*"?{type:c.Universal,namespace:l}:{type:c.Tag,name:d,namespace:l})}}}return E(),e}var j=i=>{for(;i.hasChildNodes();)i.firstChild.remove()},C=(i,t,e,n)=>i.addEventListener(t,e,n),Lt=(i,t,e,n)=>{t.forEach(s=>C(i,s,e,n))},a=(i,...t)=>{let[e]=H(i).map(n=>n.reduce((s,r)=>(s===null&&r.type!=="tag"&&(s=document.createElement("div")),r.type==="tag"?document.createElement(r.name):(r.type==="attribute"&&r.name!=="class"&&s.setAttribute(r.name,r.value??""),r.type==="attribute"&&r.name==="class"&&s.classList.add(r.value),s)),null));return t.forEach(n=>e.append(n)),e},u=i=>document.createTextNode(i),z=class{#t;constructor(t,...e){this.#t=a(t,...e)}addClass(...t){this.element().classList.add(...t)}append(...t){return this.element().append(...t)}element(){return this.#t}empty(){j(this.element())}on(t,e,n){C(this.element(),t,e,n)}onEach(t,e,n){Lt(this.element(),t,e,n)}removeClass(...t){this.element().classList.remove(...t)}},I=z;var Y=class extends I{#t="";constructor(){super('span.letter[tabindex="-1"]')}hasValue(){return this.#t!==""}highlight(t){if(t===f.RIGHT){this.element().classList.add("right");return}if(t===f.WRONG_PLACE){this.element().classList.add("wrong-place");return}if(t===f.WRONG){this.element().classList.add("wrong");return}}setValue(t){this.#t=t,this.empty(),this.append(u(t))}value(){return this.#t}},L=Y;var S=class extends I{#t=[];#e;constructor(t){super(".guess"),this.#e=t;for(let e=0;e<t;e++)this.#t.push(new L);this.append(...this.#t.map(e=>e.element()))}applyScore(t){this.#t.forEach((e,n)=>e.highlight(t[n]))}clearError(){this.element().classList.remove("error")}guess(){return this.#t.map(t=>t.value())}highlightError(){this.element().classList.add("error")}length(){return this.#t.filter(t=>t.hasValue()).length}onInput(t){if(!(t==="Backspace"&&this.length()===0)){if(t==="Backspace"){this.clearError(),this.#t[this.length()-1].setValue("");return}this.length()!==this.#e&&this.#t[this.length()].setValue(t)}}},mt=S;var J=class extends I{#t=!1;#e;#i=[];constructor(t){super('section.guesses[tabindex="0"][aria-label="Enter your guess"][autofocus]'),this.#e=t,this.addGuess()}addGuess(){this.#i.push(new mt(this.#e.currentWordLength())),this.append(this.currentGuess().element()),this.element().scrollTo({top:this.element().scrollHeight})}currentGuess(){return this.#i[this.#i.length-1]}onInput(t){if(this.#t)return;let e=this.currentGuess().guess(),n=this.currentGuess().length()===this.#e.currentWordLength(),s=this.#e.validate(e);if(t==="Enter"&&n&&s){let r=this.#e.score(e);if(this.currentGuess().applyScore(r),r.every(m=>m===f.RIGHT)){this.#t=!0;return}this.addGuess();return}t==="Enter"&&n&&!s&&this.currentGuess().highlightError(),t==="Backspace"&&this.currentGuess().onInput(t),t.match(/^[A-Z]$/i)&&this.currentGuess().onInput(t.toUpperCase())}},pt=J;var K=class extends I{#t;constructor(...t){super('dialog[tabindex="0"]'),this.#t=a(".content",...t),this.element().append(this.#t),document.body.append(this.element()),this.bindEvents()}append(...t){this.#t.append(...t)}bindEvents(){this.on("click",t=>{t.target===this.element()&&this.close()}),this.on("keydown",t=>{t.key==="Escape"&&this.close()})}close(){this.element().removeAttribute("open")}open(){this.element().setAttribute("open",""),this.element().focus()}setLabel(t){this.element().setAttribute("aria-label",t)}},bt=K;var ft=i=>i.setAttribute("hidden",""),At=i=>i.removeAttribute("hidden"),P=class extends bt{constructor(t){super(a("h2",u("Options"))),this.addClass("options"),this.setLabel("Options dialog. Close with Escape key");let e=a("select#mode",...M.map(o=>a(`option[value="${o}"]`+(o===t.mode()?"[selected]":""),u(F(o))))),n=a("select#theme",...Q.map(({label:o,path:l})=>a(`option[value="${l}"]`+(l===t.theme()?"[selected]":""),u(o)))),s=a("select#difficulty",...R.map(o=>a(`option[value="${o}"]`+(o===t.difficulty()?"[selected]":""),u(W(o))))),r=a("fieldset",a('label[for="mode"][aria-label="Choose game mode"]',u("Game mode")),e),m=a("fieldset"+(t.mode()!==G.THEMED?"[hidden]":""),a('label[for="mode"][aria-label="Choose theme"]',u("Theme")),n),p=a("fieldset"+(t.mode()!==G.THEMED?"[hidden]":""),a('label[for="difficulty"][aria-label="Choose difficulty"]',u("Difficulty")),s),g=a("button",u("Apply")),b=o=>{if(o=lt(o),t.setMode(o),o===G.THEMED){At(p),At(m);return}ft(p),ft(m)},h=o=>t.setTheme(o),E=o=>t.setDifficulty(it(o));C(e,"change",()=>b(e.value)),C(n,"change",()=>h(n.value)),C(s,"change",()=>E(s.value)),C(g,"click",()=>{t.start(),this.close()}),this.append(a("div",r,m,p,a("fieldset",g)))}},Ct=P;var $=class extends I{constructor(t){super("nav.header",a("header",a("h1",u("Wordle Kids")),a("section.actions")),a("h3",u(F(t.mode())+(t.mode()===G.THEMED?` (${rt(t.theme())}) - ${W(t.difficulty())}`:""))),a("p",u("A kid-friendly Wordle clone with small words and clues.")),a(".clues"));let e=this.element().querySelector(".clues"),n=new Ct(t),s=this.element().querySelector("section.actions"),r=a('button[title="New game"]',u("\u21BB")),m=a('button[title="Get a hint"]',u("?")),p=a('button[title="Options"]',u("\u2699"));C(r,"click",g=>{t.start(),g.preventDefault(),g.stopPropagation()}),C(m,"click",g=>{let b=e.childNodes.length,h=t.currentTarget().clues??[];g.preventDefault(),g.stopPropagation(),b===h.length&&e.append(a("p",u("No more clues!"))),!(b>=h.length)&&e.append(a("p",u(h[b])))}),C(p,"click",g=>{n.open(),g.preventDefault(),g.stopPropagation()}),s.append(r,m,p)}},Gt=$;var It={Backspace:"\u232B"},q=class extends I{#t;#e;#i={};#n=[["Q","W","E","R","T","Y","U","I","O","P"],["A","S","D","F","G","H","J","K","L"],["Backspace","Z","X","C","V","B","N","M","Enter"]];constructor(t,e){super("section.keyboard[autofocus]"),this.append(...this.#n.map(n=>a("section.row",...n.map(s=>{let r=new L;return this.#i[s]=r,r.setValue(s),r.element().setAttribute("data-key",s),Object.prototype.hasOwnProperty.call(It,s)&&(r.empty(),r.append(u(It[s]??s))),r.on("click",()=>this.handleInput(s)),r.element()})))),this.#e=t,this.#t=e,this.bindKeyboard()}bindKeyboard(){C(document,"keydown",t=>this.handleInput(t.key))}handleInput(t){this.#e.onInput(t),this.#n.flat().forEach(e=>{let n=this.#i[e],s=this.#t.letterScore(e);n.highlight(s)})}},vt=q;var y=new dt(()=>{let i=new Gt(y),t=new pt(y),e=new vt(t,y),n=document.getElementById("app");j(n),n.append(i.element(),t.element(),e.element())});y.setDifficulty(w.EASY);y.setLengths(st);y.setMode(G.THEMED);y.setTheme("./lists/themes/animals.json");y.start();})();
//# sourceMappingURL=app.js.map
